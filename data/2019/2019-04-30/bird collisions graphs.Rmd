---
title: "bird collisions graphs"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(here)
# library(jkmisc)
library(patchwork)

bird_collisions <- read_csv("bird_collisions.csv")

```
```{r}
plot_data <- bird_collisions %>%
  filter(locality == "CHI") %>% 
  mutate(month = month(date),
         year = year(date)) %>% 
  unite("binomial_name", genus, species, sep = " ") %>% 
  count(year, month, binomial_name) %>% 
  complete(nesting(year, binomial_name), month = 1:12, fill = list(n = 0)) %>%  #combinatrics 
  group_by(year, binomial_name) %>% 
  mutate(percent = n/sum(n)) %>% #perc of this year
  mutate(percent = ifelse(is.nan(percent), 0, percent))
```
```{r}
flower <- ggplot(plot_data, aes(x = month, y = percent, fill = binomial_name)) +
  geom_area(size = 0, position = position_dodge(), alpha = 0.2) +
  scale_x_continuous(labels = month.abb, breaks = 1:12) +
  scale_y_continuous(limits = c(0,1), breaks = c(0.5, 0.1)) +
  scale_fill_viridis_d("Year", option = "plasma", direction = 1) +
  scale_color_viridis_d(option = "plasma", direction = 1) +
  guides(fill = guide_colorbar()) +
  coord_polar() +
  labs(x = NULL,
       y = NULL,
       title = "Overall") +
  # theme_jk(dark = FALSE, grid = "X", strip_text_size = 10, plot_title_size = 14) +
  theme(axis.text = element_blank(),
        legend.position = "none")
flower
```

